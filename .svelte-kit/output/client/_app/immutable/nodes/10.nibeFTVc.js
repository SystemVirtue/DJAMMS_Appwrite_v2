import{S as Ne,i as qe,s as Le,q as be,r as X,u as z,v as Y,w as Q,x as W,y as Z,z as Te,A as Ye,B as je,C as Re,D as Be,d as h,G as ye,b as R,H as K,e as c,h as Ue,f as C,g as v,j as D,m as M,o as w,L as pe,p as Fe,M as He,n as oe,k as G,c as d,E as ze,I as _e,Q as Ie,a0 as Oe,a as ve,O as ue,l as we,t as ke}from"../chunks/BdqU9rtY.js";import{g as Ke}from"../chunks/BzC_WLbs.js";import"../chunks/IHki7fMi.js";import{c as De,d as le,p as Ge}from"../chunks/zxdJXzVg.js";import{p as he}from"../chunks/C0okxqSP.js";import{I as Je,w as Xe}from"../chunks/BGpGyOKF.js";import{g as Qe}from"../chunks/Di-L13FK.js";import{U as We}from"../chunks/CecWn9R4.js";import{S as Ze,a as et,P as tt}from"../chunks/CCD9zl8O.js";import{V as Se}from"../chunks/CgE6rGxY.js";import{I as rt,g as ot,a as nt}from"../chunks/Dp8WnmVE.js";import{M as at}from"../chunks/V5CP_TY7.js";import{P as lt}from"../chunks/OiUjXaK0.js";const it=!0,ge=it;function st(l){let t;const r=l[2].default,e=Ye(r,l,l[3],null);return{c(){e&&e.c()},l(a){e&&e.l(a)},m(a,i){e&&e.m(a,i),t=!0},p(a,i){e&&e.p&&(!t||i&8)&&je(e,r,a,a[3],t?Be(r,a[3],i,null):Re(a[3]),null)},i(a){t||(Y(e,a),t=!0)},o(a){z(e,a),t=!1},d(a){e&&e.d(a)}}}function ct(l){let t,r;const e=[{name:"maximize-2"},l[1],{iconNode:l[0]}];let a={$$slots:{default:[st]},$$scope:{ctx:l}};for(let i=0;i<e.length;i+=1)a=be(a,e[i]);return t=new rt({props:a}),{c(){Z(t.$$.fragment)},l(i){W(t.$$.fragment,i)},m(i,k){Q(t,i,k),r=!0},p(i,[k]){const p=k&3?ot(e,[e[0],k&2&&nt(i[1]),k&1&&{iconNode:i[0]}]):{};k&8&&(p.$$scope={dirty:k,ctx:i}),t.$set(p)},i(i){r||(Y(t.$$.fragment,i),r=!0)},o(i){z(t.$$.fragment,i),r=!1},d(i){X(t,i)}}}function ut(l,t,r){let{$$slots:e={},$$scope:a}=t;const i=[["polyline",{points:"15 3 21 3 21 9"}],["polyline",{points:"9 21 3 21 3 15"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14"}]];return l.$$set=k=>{r(1,t=be(be({},t),Te(k))),"$$scope"in k&&r(3,a=k.$$scope)},t=Te(t),[i,t,e,a]}class dt extends Ne{constructor(t){super(),qe(this,t,ut,ct,Le,{})}}const{document:$e,window:ft}=Ke;function mt(l){let t,r,e,a,i,k,p,s,m,I,u,x,b,f,y,A,T,N,B,V,P,E,_,S,U,q,j,F,O,H,ee,ne,ie;const se=[bt,gt],J=[];function ce(n,g){return n[2]?n[3]?-1:1:0}~(e=ce(l))&&(a=J[e]=se[e](l)),m=new Ze({props:{class:"w-6 h-6"}});const fe=[_t,yt],te=[];function me(n,g){return n[8].canPause?0:1}x=me(l),b=te[x]=fe[x](l),A=new et({props:{class:"w-6 h-6"}}),P=new Se({props:{class:"w-5 h-5"}}),S=new Se({props:{class:"w-5 h-5"}}),j=new dt({props:{class:"w-5 h-5"}});let L=l[2]&&l[5]>0&&Ce(l),o=l[7].isAuthenticated&&Ae();return{c(){t=w("div"),r=M(),a&&a.c(),i=M(),k=w("div"),p=w("div"),s=w("button"),Z(m.$$.fragment),I=M(),u=w("button"),b.c(),f=M(),y=w("button"),Z(A.$$.fragment),T=M(),N=w("div"),B=M(),V=w("button"),Z(P.$$.fragment),E=M(),_=w("button"),Z(S.$$.fragment),U=M(),q=w("button"),Z(j.$$.fragment),F=M(),L&&L.c(),O=M(),o&&o.c(),H=Ie(),this.h()},l(n){t=v(n,"DIV",{class:!0}),D(t).forEach(h),r=C(n),a&&a.l(n),i=C(n),k=v(n,"DIV",{class:!0});var g=D(k);p=v(g,"DIV",{class:!0});var $=D(p);s=v($,"BUTTON",{class:!0,title:!0});var re=D(s);W(m.$$.fragment,re),re.forEach(h),I=C($),u=v($,"BUTTON",{class:!0,title:!0});var ae=D(u);b.l(ae),ae.forEach(h),f=C($),y=v($,"BUTTON",{class:!0,title:!0});var Pe=D(y);W(A.$$.fragment,Pe),Pe.forEach(h),T=C($),N=v($,"DIV",{class:!0}),D(N).forEach(h),B=C($),V=v($,"BUTTON",{class:!0,title:!0});var xe=D(V);W(P.$$.fragment,xe),xe.forEach(h),E=C($),_=v($,"BUTTON",{class:!0,title:!0});var Ve=D(_);W(S.$$.fragment,Ve),Ve.forEach(h),U=C($),q=v($,"BUTTON",{class:!0,title:!0});var Ee=D(q);W(j.$$.fragment,Ee),Ee.forEach(h),$.forEach(h),g.forEach(h),F=C(n),L&&L.l(n),O=C(n),o&&o.l(n),H=Ie(),this.h()},h(){c(t,"class","absolute inset-0"),c(s,"class","p-2 text-white hover:text-youtube-red transition-colors"),c(s,"title","Skip backward 10s (‚Üê)"),c(u,"class","p-3 bg-youtube-red hover:bg-youtube-red/80 rounded-full text-white transition-colors"),c(u,"title","Play/Pause (Space)"),c(y,"class","p-2 text-white hover:text-youtube-red transition-colors"),c(y,"title","Skip forward 10s (‚Üí)"),c(N,"class","w-px h-8 bg-white/20 mx-2"),c(V,"class","p-2 text-white hover:text-youtube-red transition-colors"),c(V,"title","Volume down (‚Üì)"),c(_,"class","p-2 text-white hover:text-youtube-red transition-colors"),c(_,"title","Volume up (‚Üë)"),c(q,"class","p-2 text-white hover:text-youtube-red transition-colors"),c(q,"title","Fullscreen (F)"),c(p,"class","glass-morphism rounded-full px-6 py-3 flex items-center gap-4"),c(k,"class","floating-controls")},m(n,g){R(n,t,g),l[20](t),R(n,r,g),~e&&J[e].m(n,g),R(n,i,g),R(n,k,g),d(k,p),d(p,s),Q(m,s,null),d(p,I),d(p,u),te[x].m(u,null),d(p,f),d(p,y),Q(A,y,null),d(p,T),d(p,N),d(p,B),d(p,V),Q(P,V,null),d(p,E),d(p,_),Q(S,_,null),d(p,U),d(p,q),Q(j,q,null),R(n,F,g),L&&L.m(n,g),R(n,O,g),o&&o.m(n,g),R(n,H,g),ee=!0,ne||(ie=[K(s,"click",l[12]),K(u,"click",l[10]),K(y,"click",l[11]),K(V,"click",l[22]),K(_,"click",l[23]),K(q,"click",l[24])],ne=!0)},p(n,g){let $=e;e=ce(n),e===$?~e&&J[e].p(n,g):(a&&(_e(),z(J[$],1,1,()=>{J[$]=null}),ye()),~e?(a=J[e],a?a.p(n,g):(a=J[e]=se[e](n),a.c()),Y(a,1),a.m(i.parentNode,i)):a=null);let re=x;x=me(n),x!==re&&(_e(),z(te[re],1,1,()=>{te[re]=null}),ye(),b=te[x],b||(b=te[x]=fe[x](n),b.c()),Y(b,1),b.m(u,null)),n[2]&&n[5]>0?L?L.p(n,g):(L=Ce(n),L.c(),L.m(O.parentNode,O)):L&&(L.d(1),L=null),n[7].isAuthenticated?o||(o=Ae(),o.c(),o.m(H.parentNode,H)):o&&(o.d(1),o=null)},i(n){ee||(Y(a),Y(m.$$.fragment,n),Y(b),Y(A.$$.fragment,n),Y(P.$$.fragment,n),Y(S.$$.fragment,n),Y(j.$$.fragment,n),ee=!0)},o(n){z(a),z(m.$$.fragment,n),z(b),z(A.$$.fragment,n),z(P.$$.fragment,n),z(S.$$.fragment,n),z(j.$$.fragment,n),ee=!1},d(n){n&&(h(t),h(r),h(i),h(k),h(F),h(O),h(H)),l[20](null),~e&&J[e].d(n),X(m),te[x].d(),X(A),X(P),X(S),X(j),L&&L.d(n),o&&o.d(n),ne=!1,ze(ie)}}}function pt(l){let t,r,e,a,i,k="Authentication Required",p,s,m="You need to be signed in to access the DJAMMS video player.",I,u,x="Please sign in to continue using DJAMMS.",b,f,y,A="Return to Dashboard",T,N,B;return e=new We({props:{class:"w-20 h-20 text-red-400 mx-auto mb-6"}}),{c(){t=w("div"),r=w("div"),Z(e.$$.fragment),a=M(),i=w("h2"),i.textContent=k,p=M(),s=w("p"),s.textContent=m,I=M(),u=w("p"),u.textContent=x,b=M(),f=w("div"),y=w("button"),y.textContent=A,this.h()},l(V){t=v(V,"DIV",{class:!0});var P=D(t);r=v(P,"DIV",{class:!0});var E=D(r);W(e.$$.fragment,E),a=C(E),i=v(E,"H2",{class:!0,"data-svelte-h":!0}),G(i)!=="svelte-1f6nhhb"&&(i.textContent=k),p=C(E),s=v(E,"P",{class:!0,"data-svelte-h":!0}),G(s)!=="svelte-sm1e96"&&(s.textContent=m),I=C(E),u=v(E,"P",{class:!0,"data-svelte-h":!0}),G(u)!=="svelte-l9zltp"&&(u.textContent=x),b=C(E),f=v(E,"DIV",{class:!0});var _=D(f);y=v(_,"BUTTON",{class:!0,"data-svelte-h":!0}),G(y)!=="svelte-ezq80s"&&(y.textContent=A),_.forEach(h),E.forEach(h),P.forEach(h),this.h()},h(){c(i,"class","text-white text-3xl font-bold mb-4"),c(s,"class","text-red-300 text-xl mb-6"),c(u,"class","text-gray-400 mb-8"),c(y,"class","px-6 py-3 bg-youtube-red hover:bg-red-700 text-white rounded-lg font-semibold transition-colors"),c(f,"class","flex gap-4 justify-center"),c(r,"class","text-center p-8 max-w-2xl"),c(t,"class","absolute inset-0 bg-gradient-to-br from-youtube-dark via-youtube-darker to-music-purple flex items-center justify-center")},m(V,P){R(V,t,P),d(t,r),Q(e,r,null),d(r,a),d(r,i),d(r,p),d(r,s),d(r,I),d(r,u),d(r,b),d(r,f),d(f,y),T=!0,N||(B=K(y,"click",l[19]),N=!0)},p:oe,i(V){T||(Y(e.$$.fragment,V),T=!0)},o(V){z(e.$$.fragment,V),T=!1},d(V){V&&h(t),X(e),N=!1,B()}}}function ht(l){let t,r='<div class="text-center p-8 max-w-2xl"><div class="w-16 h-16 border-4 border-youtube-red border-t-transparent rounded-full animate-spin mx-auto mb-4"></div> <h2 class="text-white text-xl font-semibold mb-2">Checking Authentication...</h2> <p class="text-gray-400">Verifying your login status</p></div>';return{c(){t=w("div"),t.innerHTML=r,this.h()},l(e){t=v(e,"DIV",{class:!0,"data-svelte-h":!0}),G(t)!=="svelte-1u6z3mn"&&(t.innerHTML=r),this.h()},h(){c(t,"class","absolute inset-0 bg-gradient-to-br from-youtube-dark via-youtube-darker to-music-purple flex items-center justify-center")},m(e,a){R(e,t,a)},p:oe,i:oe,o:oe,d(e){e&&h(t)}}}function gt(l){let t,r,e,a,i,k="No Songs in Queue",p,s,m="The playlist is empty. Add some songs to get started!",I,u,x="Use the queue manager to add tracks to your playlist.",b,f,y,A="Open Queue Manager",T,N,B;return e=new at({props:{class:"w-20 h-20 text-youtube-red mx-auto mb-6"}}),{c(){t=w("div"),r=w("div"),Z(e.$$.fragment),a=M(),i=w("h2"),i.textContent=k,p=M(),s=w("p"),s.textContent=m,I=M(),u=w("p"),u.textContent=x,b=M(),f=w("div"),y=w("button"),y.textContent=A,this.h()},l(V){t=v(V,"DIV",{class:!0});var P=D(t);r=v(P,"DIV",{class:!0});var E=D(r);W(e.$$.fragment,E),a=C(E),i=v(E,"H2",{class:!0,"data-svelte-h":!0}),G(i)!=="svelte-mprd5t"&&(i.textContent=k),p=C(E),s=v(E,"P",{class:!0,"data-svelte-h":!0}),G(s)!=="svelte-wmdo1i"&&(s.textContent=m),I=C(E),u=v(E,"P",{class:!0,"data-svelte-h":!0}),G(u)!=="svelte-gz9hx5"&&(u.textContent=x),b=C(E),f=v(E,"DIV",{class:!0});var _=D(f);y=v(_,"BUTTON",{class:!0,"data-svelte-h":!0}),G(y)!=="svelte-zqrxx8"&&(y.textContent=A),_.forEach(h),E.forEach(h),P.forEach(h),this.h()},h(){c(i,"class","text-white text-3xl font-bold mb-4"),c(s,"class","text-gray-300 text-xl mb-6"),c(u,"class","text-gray-400 mb-8"),c(y,"class","px-6 py-3 bg-youtube-red hover:bg-red-700 text-white rounded-lg font-semibold transition-colors"),c(f,"class","flex gap-4 justify-center"),c(r,"class","text-center p-8 max-w-2xl"),c(t,"class","absolute inset-0 bg-gradient-to-br from-youtube-dark via-youtube-darker to-music-purple flex items-center justify-center")},m(V,P){R(V,t,P),d(t,r),Q(e,r,null),d(r,a),d(r,i),d(r,p),d(r,s),d(r,I),d(r,u),d(r,b),d(r,f),d(f,y),T=!0,N||(B=K(y,"click",l[21]),N=!0)},p:oe,i(V){T||(Y(e.$$.fragment,V),T=!0)},o(V){z(e.$$.fragment,V),T=!1},d(V){V&&h(t),X(e),N=!1,B()}}}function bt(l){let t,r='<div class="text-center"><div class="w-16 h-16 border-4 border-youtube-red border-t-transparent rounded-full animate-spin mx-auto mb-4"></div> <h2 class="text-white text-xl font-semibold mb-2">Loading Player...</h2> <p class="text-gray-400">Initializing YouTube video player</p></div>';return{c(){t=w("div"),t.innerHTML=r,this.h()},l(e){t=v(e,"DIV",{class:!0,"data-svelte-h":!0}),G(t)!=="svelte-1q0q0nq"&&(t.innerHTML=r),this.h()},h(){c(t,"class","absolute inset-0 bg-black flex items-center justify-center")},m(e,a){R(e,t,a)},p:oe,i:oe,o:oe,d(e){e&&h(t)}}}function yt(l){let t,r;return t=new lt({props:{class:"w-8 h-8 ml-1"}}),{c(){Z(t.$$.fragment)},l(e){W(t.$$.fragment,e)},m(e,a){Q(t,e,a),r=!0},i(e){r||(Y(t.$$.fragment,e),r=!0)},o(e){z(t.$$.fragment,e),r=!1},d(e){X(t,e)}}}function _t(l){let t,r;return t=new tt({props:{class:"w-8 h-8"}}),{c(){Z(t.$$.fragment)},l(e){W(t.$$.fragment,e)},m(e,a){Q(t,e,a),r=!0},i(e){r||(Y(t.$$.fragment,e),r=!0)},o(e){z(t.$$.fragment,e),r=!1},d(e){X(t,e)}}}function Ce(l){var E;let t,r,e,a,i=de(l[4])+"",k,p,s,m,I=de(l[5])+"",u,x,b,f,y,A,T,N,B,V,P=((E=l[9])==null?void 0:E.title)&&Me(l);return{c(){t=w("div"),r=w("div"),e=w("div"),a=w("span"),k=ke(i),p=M(),P&&P.c(),s=M(),m=w("span"),u=ke(I),x=M(),b=w("div"),f=w("div"),y=w("div"),A=M(),T=w("div"),this.h()},l(_){t=v(_,"DIV",{class:!0});var S=D(t);r=v(S,"DIV",{class:!0});var U=D(r);e=v(U,"DIV",{class:!0});var q=D(e);a=v(q,"SPAN",{class:!0});var j=D(a);k=we(j,i),j.forEach(h),p=C(q),P&&P.l(q),s=C(q),m=v(q,"SPAN",{class:!0});var F=D(m);u=we(F,I),F.forEach(h),q.forEach(h),x=C(U),b=v(U,"DIV",{class:!0});var O=D(b);f=v(O,"DIV",{class:!0,"data-timeline":!0,role:!0,tabindex:!0,"aria-label":!0,"aria-valuenow":!0,"aria-valuemin":!0,"aria-valuemax":!0});var H=D(f);y=v(H,"DIV",{class:!0,style:!0}),D(y).forEach(h),A=C(H),T=v(H,"DIV",{class:!0,style:!0,role:!0,tabindex:!0,"aria-label":!0}),D(T).forEach(h),H.forEach(h),O.forEach(h),U.forEach(h),S.forEach(h),this.h()},h(){c(a,"class","font-medium"),c(m,"class","font-medium"),c(e,"class","flex items-center justify-between text-white text-sm mb-2"),c(y,"class","h-full bg-youtube-red rounded-full transition-all duration-100 ease-out"),ue(y,"width",(l[5]>0?l[4]/l[5]*100:0)+"%"),c(T,"class",N="absolute top-1/2 -translate-y-1/2 w-4 h-4 bg-white rounded-full shadow-lg cursor-grab active:cursor-grabbing transition-all duration-100 ease-out "+(l[6]?"scale-125":"")),ue(T,"left","calc("+(l[5]>0?l[4]/l[5]*100:0)+"% - 8px)"),c(T,"role","button"),c(T,"tabindex","0"),c(T,"aria-label","Drag to seek"),c(f,"class","w-full h-2 bg-white/20 rounded-full cursor-pointer"),c(f,"data-timeline",""),c(f,"role","slider"),c(f,"tabindex","0"),c(f,"aria-label","Seek timeline"),c(f,"aria-valuenow",l[4]),c(f,"aria-valuemin","0"),c(f,"aria-valuemax",l[5]),c(b,"class","relative"),c(r,"class","glass-morphism rounded-lg px-4 py-3"),c(t,"class","absolute bottom-4 left-4 right-4")},m(_,S){R(_,t,S),d(t,r),d(r,e),d(e,a),d(a,k),d(e,p),P&&P.m(e,null),d(e,s),d(e,m),d(m,u),d(r,x),d(r,b),d(b,f),d(f,y),d(f,A),d(f,T),B||(V=[K(T,"mousedown",l[15]),K(f,"click",l[14]),K(f,"keydown",l[16])],B=!0)},p(_,S){var U;S[0]&16&&i!==(i=de(_[4])+"")&&ve(k,i),(U=_[9])!=null&&U.title?P?P.p(_,S):(P=Me(_),P.c(),P.m(e,s)):P&&(P.d(1),P=null),S[0]&32&&I!==(I=de(_[5])+"")&&ve(u,I),S[0]&48&&ue(y,"width",(_[5]>0?_[4]/_[5]*100:0)+"%"),S[0]&64&&N!==(N="absolute top-1/2 -translate-y-1/2 w-4 h-4 bg-white rounded-full shadow-lg cursor-grab active:cursor-grabbing transition-all duration-100 ease-out "+(_[6]?"scale-125":""))&&c(T,"class",N),S[0]&48&&ue(T,"left","calc("+(_[5]>0?_[4]/_[5]*100:0)+"% - 8px)"),S[0]&16&&c(f,"aria-valuenow",_[4]),S[0]&32&&c(f,"aria-valuemax",_[5])},d(_){_&&h(t),P&&P.d(),B=!1,ze(V)}}}function Me(l){let t,r=l[9].title+"",e;return{c(){t=w("span"),e=ke(r),this.h()},l(a){t=v(a,"SPAN",{class:!0});var i=D(t);e=we(i,r),i.forEach(h),this.h()},h(){c(t,"class","text-center flex-1 truncate px-4")},m(a,i){R(a,t,i),d(t,e)},p(a,i){i[0]&512&&r!==(r=a[9].title+"")&&ve(e,r)},d(a){a&&h(t)}}}function Ae(l){let t,r='<div class="glass-morphism rounded-lg p-3 text-white text-sm opacity-75"><div class="font-semibold mb-2">Keyboard Shortcuts</div> <div class="space-y-1 text-xs"><div><kbd class="bg-white/20 px-1 rounded">Space</kbd> Play/Pause</div> <div><kbd class="bg-white/20 px-1 rounded">‚Üê‚Üí</kbd> Skip 10s</div> <div><kbd class="bg-white/20 px-1 rounded">Shift+‚Üê‚Üí</kbd> Seek 30s</div> <div><kbd class="bg-white/20 px-1 rounded">‚Üë‚Üì</kbd> Volume</div> <div><kbd class="bg-white/20 px-1 rounded">Home/End</kbd> Start/End</div> <div><kbd class="bg-white/20 px-1 rounded">F</kbd> Fullscreen</div></div></div>';return{c(){t=w("div"),t.innerHTML=r,this.h()},l(e){t=v(e,"DIV",{class:!0,"data-svelte-h":!0}),G(t)!=="svelte-5c4tro"&&(t.innerHTML=r),this.h()},h(){c(t,"class","absolute top-4 right-4")},m(e,a){R(e,t,a)},d(e){e&&h(t)}}}function vt(l){let t,r,e,a,i,k,p;const s=[ht,pt,mt],m=[];function I(u,x){return u[7].isLoading?0:u[7].isAuthenticated?2:1}return e=I(l),a=m[e]=s[e](l),{c(){t=M(),r=w("main"),a.c(),this.h()},l(u){Ue("svelte-1pbsqsz",$e.head).forEach(h),t=C(u),r=v(u,"MAIN",{class:!0});var b=D(r);a.l(b),b.forEach(h),this.h()},h(){$e.title="Video Player - DJAMMS",c(r,"class","youtube-player")},m(u,x){R(u,t,x),R(u,r,x),m[e].m(r,null),i=!0,k||(p=K(ft,"keydown",l[17]),k=!0)},p(u,x){let b=e;e=I(u),e===b?m[e].p(u,x):(_e(),z(m[b],1,1,()=>{m[b]=null}),ye(),a=m[e],a?a.p(u,x):(a=m[e]=s[e](u),a.c()),Y(a,1),a.m(r,null))},i(u){i||(Y(a),i=!0)},o(u){z(a),i=!1},d(u){u&&(h(t),h(r)),m[e].d(),k=!1,p()}}}let wt=!0;function de(l){if(!l||isNaN(l))return"0:00";const t=Math.floor(l/3600),r=Math.floor(l%3600/60),e=Math.floor(l%60);return t>0?`${t}:${r.toString().padStart(2,"0")}:${e.toString().padStart(2,"0")}`:`${r}:${e.toString().padStart(2,"0")}`}function kt(l,t,r){let e,a,i;pe(l,le,o=>r(7,e=o)),pe(l,Ge,o=>r(8,a=o)),pe(l,De,o=>r(9,i=o));const k=void 0;let p,s,m=!1,I="",u=Je.player(),x;Qe();let b=0,f=0,y=!1;Fe(async()=>{if(Xe.shouldPreventDuplicate()){alert("Video Player is already open in another window. Redirecting to dashboard."),window.location.href="/djamms-dashboard";return}if(console.log("üéµ VideoPlayer: Player instance ID:",u),De.subscribe(o=>{o&&o.video_id&&o.video_id!==I&&(console.log("üéµ VideoPlayer: New track from venue:",o.title),_(o.video_id,o.title||"Unknown Track"))}),he.initialize(),window.addEventListener("track-change-request",E),window.YT)A();else try{const o=document.createElement("script");o.src="https://www.youtube.com/iframe_api",o.onerror=n=>{console.error("üéµ VideoPlayer: Failed to load YouTube API script:",n)},document.head.appendChild(o),window.onYouTubeIframeAPIReady=()=>{try{console.log("üéµ YouTube API loaded"),A()}catch(n){console.error("üéµ VideoPlayer: Error in YouTube API ready callback:",n)}}}catch(o){console.error("üéµ VideoPlayer: Error loading YouTube API:",o)}});async function A(){console.log("üéµ VideoPlayer: YouTube API ready, checking for current track...");try{const o=e.currentVenue;if(o&&o.now_playing)console.log("üéµ VideoPlayer: Found current track, loading:",o.now_playing.title),_(o.now_playing.video_id,o.now_playing.title);else{console.log("üéµ VideoPlayer: No current track, checking if playlist is loaded...");try{await le.loadPlaylists(),console.log("üéµ VideoPlayer: Playlists loaded, checking for available tracks...");const n=e.currentVenue;if(n&&n.now_playing)console.log("üéµ VideoPlayer: Found track after playlist load, loading:",n.now_playing.title),_(n.now_playing.video_id,n.now_playing.title);else if(n&&n.active_queue&&n.active_queue.length>0){console.log("üéµ VideoPlayer: Found active queue, loading first track");const g=n.active_queue[0];_(g.video_id,g.title||"Unknown Track")}else console.log("üéµ VideoPlayer: No tracks available after playlist load, showing empty state"),r(2,m=!0)}catch(n){console.error("üéµ VideoPlayer: Failed to load playlists:",n),console.error("üéµ VideoPlayer: Showing empty state due to load failure"),r(2,m=!0)}}}catch(o){console.error("üéµ VideoPlayer: Error checking current state:",o),r(2,m=!0)}}He(()=>{x&&clearInterval(x),window.removeEventListener("track-change-request",E),document.removeEventListener("mousemove",ne),document.removeEventListener("mouseup",ee),he.broadcastDisconnection(u);try{s&&s.destroy&&s.destroy()}catch(o){console.error("üéµ VideoPlayer: Error destroying player:",o)}});function T(){try{if(!p)return;if(!I){console.error("üéµ VideoPlayer: Cannot initialize - no video ID available");return}console.log("üéµ VideoPlayer: Initializing YouTube player with video:",I),r(1,s=new window.YT.Player(p,{height:"100%",width:"100%",videoId:I,playerVars:{autoplay:wt?1:0,controls:0,disablekb:1,fs:0,iv_load_policy:3,modestbranding:1,rel:0,showinfo:0},events:{onReady:N,onStateChange:B}}))}catch(o){console.error("üéµ VideoPlayer: Error initializing player:",o),setTimeout(()=>{console.log("üéµ VideoPlayer: Retrying player initialization..."),T()},2e3)}}function N(){try{r(2,m=!0),s.setVolume(75),x&&clearInterval(x),x=setInterval(P,1e3)}catch(o){console.error("üéµ VideoPlayer: Error in onPlayerReady:",o)}}function B(o){try{const n=o.data,g=n===window.YT.PlayerState.PLAYING;if(n===window.YT.PlayerState.ENDED){console.log("üéµ Video ended, signaling ready for next song"),le.sendCommand("skip_next");return}le.sendCommand("update_player_state",{status:g?"playing":"paused",position:b}),ge&&V(g)}catch(n){console.error("üéµ VideoPlayer: Error in onPlayerStateChange:",n)}}function V(o){{const n=o?"connected-local-playing":"connected-local-paused";he.broadcastStateChange(n,u)}}function P(){try{if(!m||!s)return;const o=s.getCurrentTime(),n=s.getDuration(),$=s.getPlayerState()===window.YT.PlayerState.PLAYING;y||(r(4,b=o),r(5,f=n||0)),le.sendCommand("update_player_position",{position:o})}catch(o){console.error("üéµ VideoPlayer: Error updating player progress:",o)}}function E(o){const g=o.detail;!g||!g.video_id||(console.log("üéµ VideoPlayer: Received track change request:",g.title),r(3,I=g.video_id),le.sendCommand("update_now_playing",g),!s&&window.YT&&p?(console.log("üéµ VideoPlayer: Initializing player with requested track"),T()):m&&s&&(console.log("üéµ VideoPlayer: Loading new track in existing player"),s.loadVideoById(g.video_id)))}function _(o,n){try{console.log("üéµ VideoPlayer: Loading new video from jukebox:",n),r(3,I=o),!s&&ge&&window.YT&&p?(console.log("üéµ VideoPlayer: Initializing player with new track"),T()):m&&s&&(console.log("üéµ VideoPlayer: Loading new track in existing player"),s.loadVideoById(o))}catch(g){console.error("üéµ VideoPlayer: Error loading new video:",g)}}function S(){try{if(!m)return;s.getPlayerState()===window.YT.PlayerState.PLAYING?s.pauseVideo():s.playVideo()}catch(o){console.error("üéµ VideoPlayer: Error toggling play/pause:",o)}}function U(){try{if(!m)return;const o=s.getCurrentTime();s.seekTo(o+10)}catch(o){console.error("üéµ VideoPlayer: Error skipping forward:",o)}}function q(){try{if(!m)return;const o=s.getCurrentTime();s.seekTo(Math.max(0,o-10))}catch(o){console.error("üéµ VideoPlayer: Error skipping backward:",o)}}function j(o){try{if(!m)return;const n=s.getVolume(),g=Math.max(0,Math.min(100,n+o));s.setVolume(g)}catch(n){console.error("üéµ VideoPlayer: Error adjusting volume:",n)}}function F(o){try{if(!m)return;s.seekTo(o),r(4,b=o)}catch(n){console.error("üéµ VideoPlayer: Error seeking to time:",n)}}function O(o){if(!m||f===0)return;const g=o.currentTarget.getBoundingClientRect(),$=o.clientX-g.left,ae=Math.max(0,Math.min(1,$/g.width))*f;F(ae)}function H(o){r(6,y=!0),document.addEventListener("mousemove",ne),document.addEventListener("mouseup",ee),o.preventDefault()}function ee(){y&&(r(6,y=!1),m&&F(b)),document.removeEventListener("mousemove",ne),document.removeEventListener("mouseup",ee)}function ne(o){if(!y||f===0||!ge)return;const n=document.querySelector("[data-timeline]");if(!n)return;const g=n.getBoundingClientRect(),$=o.clientX-g.left,ae=Math.max(0,Math.min(1,$/g.width))*f;r(4,b=ae),o.preventDefault()}function ie(o){(o.code==="Enter"||o.code==="Space")&&(o.preventDefault(),O(o))}function se(o){switch(o.code){case"Space":o.preventDefault(),S();break;case"ArrowRight":o.preventDefault(),o.shiftKey?F(Math.min(f,b+30)):U();break;case"ArrowLeft":o.preventDefault(),o.shiftKey?F(Math.max(0,b-30)):q();break;case"ArrowUp":o.preventDefault(),j(10);break;case"ArrowDown":o.preventDefault(),j(-10);break;case"KeyF":o.preventDefault();try{s&&s.getIframe&&s.getIframe().requestFullscreen()}catch(n){console.error("üéµ VideoPlayer: Error requesting fullscreen:",n)}break;case"Home":o.preventDefault(),F(0);break;case"End":o.preventDefault(),f>0&&F(f);break}}const J=()=>window.location.href="/djamms-dashboard";function ce(o){Oe[o?"unshift":"push"](()=>{p=o,r(0,p)})}return[p,s,m,I,b,f,y,e,a,i,S,U,q,j,O,H,ie,se,k,J,ce,()=>window.open("/adminconsole#queue","_blank"),()=>j(-10),()=>j(10),()=>{var o;return(o=s==null?void 0:s.getIframe())==null?void 0:o.requestFullscreen()}]}class qt extends Ne{constructor(t){super(),qe(this,t,kt,vt,Le,{data:18},null,[-1,-1])}get data(){return this.$$.ctx[18]}}export{qt as component};
